
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Client Dev Build &#8212; DDOILoggerClient 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="DDOILoggerClient package" href="ddoiloggerclient.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="client-dev-build">
<h1>Client Dev Build<a class="headerlink" href="#client-dev-build" title="Permalink to this headline">¶</a></h1>
<p>The DDOILoggerClient Python module is found on Github. It is installed by first cloning the
repository to the server where it is to be run. Then the module is installed with the
pip command <cite>pip install .</cite> while in the DDOILoggerClient directory. This installs
the client to the current working python’s pip wheel.</p>
</div>
<div class="section" id="deployment-kroot-build">
<h1>Deployment (Kroot) Build<a class="headerlink" href="#deployment-kroot-build" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><p>SVN Checkout <cite>/kroot/src/util/loggerclient/</cite></p></li>
<li><p>Run <cite>make clean &amp;&amp; make</cite> to clone the repo from git hub</p></li>
<li><p>CD to <cite>/kroot/src/util/loggerclient/DDOILoggerClient</cite></p></li>
<li><p>run <cite>make clean &amp;&amp; make &amp;&amp; make install</cite></p></li>
</ol>
</div>
<div class="section" id="running-the-logger-client">
<h1>Running the Logger Client<a class="headerlink" href="#running-the-logger-client" title="Permalink to this headline">¶</a></h1>
<p>The logger client is imported and run just as any Python module. See the code below for an example client.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ddoiloggerclient</span> <span class="kn">import</span> <span class="n">DDOILoggerClient</span>

<span class="n">subsystem</span><span class="o">=</span><span class="s2">&quot;MOSFIRE&quot;</span>
<span class="n">config</span><span class="o">=</span><span class="kc">None</span>
<span class="n">author</span><span class="o">=</span><span class="s2">&quot;authorNameHere&quot;</span>
<span class="n">progid</span><span class="o">=</span><span class="s2">&quot;AProgid&quot;</span>
<span class="n">semid</span><span class="o">=</span><span class="s2">&quot;Asemid&quot;</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">DDOILogger</span><span class="o">.</span><span class="n">DDOILogger</span><span class="p">(</span><span class="n">subsystem</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="n">progid</span><span class="p">,</span> <span class="n">semid</span><span class="p">)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;an example message&quot;</span>
<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>Logger has levels: debug, info, warn, and error.
The Upon creation, the client sends a heartbeat message to the server, checking that it is alive.
If it is not, the logger returns an error. The logger then requests valid subsystems
and log levels. The logger looks for the server running on port 5570, or whatever is written in
the configuration file located at ./DDOILoggerClient/logger_cfg.ini.</p>
</div>
<div class="section" id="server-deployment">
<h1>Server Deployment<a class="headerlink" href="#server-deployment" title="Permalink to this headline">¶</a></h1>
<p>The server depends on the configuration file located at
./configs/server_cfg.ini. This describes the host address,
port number, and number of workers. Server is deployed by
first installing the libraries written in <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>
file with the pip command</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">conda activate logger &amp;&amp; pip -e requirements.txt</span>
</pre></div>
</div>
<p>The server running on vm-ddoiloggerbuild-new uses the <code class="docutils literal notranslate"><span class="pre">logger</span></code>
virtual environment.</p>
</div>
<div class="section" id="deployment">
<h1>Deployment<a class="headerlink" href="#deployment" title="Permalink to this headline">¶</a></h1>
<p>The Server that spawns and runs the workers runs as a daemon
using the Linux process manager Systemd. Scripts are run as
daemons and restarted should they unexpectedly exit.
Systemd configuration files are stored
in <code class="docutils literal notranslate"><span class="pre">/etc/systemd/system/zmq_server.service</span></code>, shown below.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[Unit]</span>
<span class="go">Description=ZMQ Logger Server</span>
<span class="go">After=multi-user.target</span>

<span class="go">[Service]</span>
<span class="go">Type=simple</span>
<span class="go">Restart=always</span>
<span class="go">ExecStart=/home/dsieng/.conda/envs/logger/bin/python /home/dsieng/DDOILoggerServer/zmq_server.py</span>

<span class="go">[Install]</span>
<span class="go">WantedBy=multi-user.target</span>
</pre></div>
</div>
<p>You can start, stop, and check the status of the daemon with the command
<code class="docutils literal notranslate"><span class="pre">systemd</span> <span class="pre">start/stop/status</span> <span class="pre">zmq_server</span></code>
Note how the service uses a Conda environment to run a python instance.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">DDOILoggerClient</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="modules.html">DDOILoggerClient</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Client Dev Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="#deployment-kroot-build">Deployment (Kroot) Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="#running-the-logger-client">Running the Logger Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="#server-deployment">Server Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="#deployment">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="ddoiloggerclient.html" title="previous chapter">DDOILoggerClient package</a></li>
      <li>Next: <a href="api.html" title="next chapter">API</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Tyler Tucker.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/build.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>